<div class="finance-container">
  <div class="fin-card">
    <div class="row gx-0 gy-0 fin-row">
      <div class="col-md-4 left-column">
        <div class="card widget-card table-card">
          <div class="card-header">
            <div class="header-wrap-outer">
              <div class="header-wrap">
                <div class="text-wrap">
                  <h6>Accounts Head</h6>
                </div>
              </div>

              <!--header right side -->
              <div class="right-side">
                <!-- button-wrap -->
                <div class="button-wrap">
                  <a
                    (click)="toggleExpand()"
                    role="button"
                    class="expand-btn"
                    [ngClass]="{ expanded: isExpanded }"
                    ><i class="icon icon-expand-form"></i
                  ></a>
                </div>
              </div>
            </div>
          </div>

          <div class="card-body">
            <div class="form-wrap table-form-wrap">
              <div class="form-body">
                <div class="row form-row">
                  <div class="col-lg-12">
                    <div class="form-group">
                      <div class="row form-inner-row">
                        <div class="col-3 left-side">
                          <label for="s-sub" class="form-label"
                            >Secondary Head</label
                          >
                        </div>

                        <div class="col-9 right-side">
                          <div class="input-group right xs">
                            <input
                              type="text"
                              name="s-sub"
                              id="s-sub"
                              class="form-control xs"
                              (dblclick)="open_heads()"
                              [(ngModel)]="selected_acc_head.parent_head"
                              readonly
                            />
                            <span class="input-group-text xs"
                              ><i class="icon icon-search-gray"></i
                            ></span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-lg-12">
                    <div class="form-group">
                      <div class="row form-inner-row">
                        <div class="col-3 left-side">
                          <label for="head-code" class="form-label"
                            >Head Code</label
                          >
                        </div>
                        <div class="col-9 right-side">
                          <input
                            #headCodeInput
                            type="text"
                            id="head-code"
                            class="form-control xs"
                            [(ngModel)]="selected_acc_head.head_code"
                            name="headCode"
                            [readOnly]="isReadOnly"
                            (input)="validateHeadCode($event)"
                            maxlength="9"
                            (keypress)="allowOnlyNumbers($event)"
                            (blur)="onHeadCodeBlur($event)"
                            [class.is-invalid]="headCodeInvalid"
                          />
                          <div *ngIf="headCodeInvalid" class="invalid-feedback">
                            {{ errorMessage }}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Head -->
                  <div class="col-lg-12">
                    <div class="form-group">
                      <div class="row form-inner-row">
                        <div class="col-3 left-side">
                          <label for="head" class="form-label">Head</label>
                        </div>
                        <div class="col-9 right-side">
                          <input
                            type="text"
                            id="head"
                            class="form-control xs"
                            [(ngModel)]="selected_acc_head.head"
                            name="head"
                            [readOnly]="isReadOnly && isEnabled"
                            maxlength="80"
                          />
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Short Description -->
                  <div class="col-lg-12">
                    <div class="form-group">
                      <div class="row form-inner-row">
                        <div class="col-3 left-side">
                          <label for="short-desc" class="form-label"
                            >Short Description</label
                          >
                        </div>
                        <div class="col-9 right-side">
                          <input
                            type="text"
                            id="short-desc"
                            class="form-control xs"
                            [(ngModel)]="selected_acc_head.short_description"
                            name="shortDesc"
                            [readOnly]="isReadOnly && isEnabled"
                            maxlength="30"
                            minlength="2"
                          />
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Primary -->
                  <div class="col-lg-12">
                    <div class="form-group">
                      <div class="row form-inner-row">
                        <div class="col-3 left-side">
                          <label for="primary" class="form-label"
                            >Primary</label
                          >
                        </div>
                        <div class="col-9 right-side">
                          <input
                            type="text"
                            id="primary"
                            class="form-control xs"
                            [(ngModel)]="selected_acc_head.primary_head"
                            name="primary"
                            readonly
                          />
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Secondary -->
                  <!-- <div class="col-lg-12">
                    <div class="form-group">
                      <div class="row form-inner-row">
                        <div class="col-3 left-side">
                          <label for="secondary" class="form-label"
                            >Secondary</label
                          >
                        </div>
                        <div class="col-9 right-side">
                          <input
                            type="text"
                            id="secondary"
                            class="form-control xs"
                            [(ngModel)]="selected_acc_head.secondary"
                            name="secondary"
                          />
                        </div>
                      </div>
                    </div>
                  </div> -->

                  <!-- Type (Select dropdown) -->
                  <div class="col-lg-12">
                    <div class="form-group">
                      <div class="row form-inner-row">
                        <div class="col-3 left-side">
                          <label for="type" class="form-label">Type</label>
                        </div>
                        <div class="col-9 right-side">
                          <input
                            type="text"
                            id="type"
                            name="type"
                            class="form-control xs"
                            [(ngModel)]="selected_acc_head.type"
                            readonly
                          />
                        </div>
                      </div>
                    </div>
                  </div>

                  <div *ngIf="!isEditing && !isAdding" class="col-lg-12">
                    <div class="form-group">
                      <div class="row form-inner-row">
                        <div class="col-3 left-side">
                          <label for="deactivate" class="form-label"
                            >Deactivate</label
                          >
                        </div>
                        <div class="col-4 right-side">
                          <div class="form-check">
                            <input
                              type="checkbox"
                              id="deactivate"
                              name="deactivate"
                              class="form-check-input"
                              [(ngModel)]="selected_acc_head.deactivate"
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- <div class="col-lg-4">
                    <div class="gradient-box">
                      <div class="gradient-box-inner">
                        <div class="heading-wrap end">
                          <div class="heading">
                            <h6 class="head">Grand Total</h6>
                            <h5 class="desc">
                              â‚¹ <span class="amount">23,980.00</span>
                            </h5>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div> -->
                </div>
              </div>

              <div class="form-footer">
                <div class="button-wrap">
                  <!-- Conditional rendering of buttons based on the edit state -->
                  <!-- Show "Save" and "Clear" when in Edit mode -->
                  <button
                    *ngIf="!isEditing"
                    class="sm btn btn-primary-90 save-btn"
                    (click)="save()"
                    [disabled]="headCodeInvalid"
                  >
                    {{ "Save" }}
                  </button>
                  <!-- Show "Edit" and "Add New" when NOT in Edit mode -->
                  <button
                    *ngIf="isEditing"
                    class="sm btn btn-primary-90 add-btn"
                    (click)="editSubject()"
                  >
                    {{ isEditing ? "Edit" : "Save" }}
                  </button>
                  <button
                    class="sm btn btn-outline-primary-90 cancel-btn"
                    (click)="init()"
                  >
                    {{ "Clear" }}
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-8 right-column">
        <div class="card widget-card table-card footer-include">
          <div class="card-header">
            <div class="header-wrap-outer">
              <div class="header-wrap">
                <div class="text-wrap">
                  <h6>Accounts Head</h6>
                </div>
              </div>
              <!-- <div *ngIf="hasDeactivatedRows" class="info-message">
                <span class="text-danger">* Some account heads are
                deactivated and shown in red.</span>
              </div> -->

              <!--header right side -->
              <div class="right-side">
                <!-- search -->
                <div class="search-wrap">
                  <div class="input-group xs">
                    <span class="input-group-text"
                      ><i class="icon icon-search-gray"></i
                    ></span>
                    <input
                      type="text"
                      name="search"
                      id="search"
                      placeholder="Search"
                      class="form-control xs"
                      (keyup)="applyFilter($event)"
                      #input
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="card-body">
            <div class="table-outer-wrap">
              <div class="table-wrap file-box-wrap pagination-included">
                <table
                  mat-table
                  [dataSource]="dataSource"
                  class="w-100 admin-table file-table"
                >
                  <!--  Head -->
                  <ng-container matColumnDef="head">
                    <th mat-header-cell *matHeaderCellDef>Head</th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.vch_head }}
                    </td>
                  </ng-container>

                  <!-- Code -->
                  <ng-container matColumnDef="code">
                    <th mat-header-cell *matHeaderCellDef>Code</th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.vch_head_code }}
                    </td>
                  </ng-container>

                  <!-- Code -->
                  <ng-container matColumnDef="secondary">
                    <th mat-header-cell *matHeaderCellDef>Secondary Head</th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.vch_secondary_head }} (
                      {{ element.vch_secondary_code }} )
                    </td>
                  </ng-container>

                  <!-- Module Column -->
                  <ng-container matColumnDef="type">
                    <th mat-header-cell *matHeaderCellDef>Type</th>
                    <td mat-cell *matCellDef="let element">
                      <span class="badge bg-gray-15 code-badge xs">{{
                        element.vch_type || ""
                      }}</span>
                    </td>
                  </ng-container>

                  <!-- Module Column -->
                  <ng-container matColumnDef="primary_head">
                    <th mat-header-cell *matHeaderCellDef>Primary</th>
                    <td mat-cell *matCellDef="let element">
                      <span class="badge bg-gray-15 code-badge xs">{{
                        element.vch_primary_head || ""
                      }}</span>
                    </td>
                  </ng-container>

                  <!-- Header and Row Definitions -->
                  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                  <tr
                    mat-row
                    *matRowDef="
                      let row;
                      let i = index;
                      columns: displayedColumns
                    "
                    (dblclick)="rowActive(row, i)"
                    [ngClass]="{ 'active-row': activeRowIndex === i }"
                    [style.backgroundColor]="
                      row.tny_flag === 2 ? '#f5d7d5' : 'transparent'
                    "
                  ></tr>
                </table>
              </div>

              <!-- MatPaginator for Pagination -->
              <mat-paginator
                [pageSizeOptions]="[5, 10, 25, 100]"
                showFirstLastButtons
              ></mat-paginator>
            </div>
          </div>

          <div class="card-footer">
            <div class="card-action-wrap">
              <button
                type="button"
                class="btn btn-primary-90 sm"
                (click)="addNew()"
              >
                Add New
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
